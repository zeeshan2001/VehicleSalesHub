function nxt_form_attach(){var e=/^mtm_(\d+)_(\d+)$/,t=/^mtm_(.+?)_(\d+)_(\d+)$/,n=new RegExp("_btn$","g"),i=new RegExp("_edit$","g"),d=new RegExp("_v$","g"),o=new RegExp("_add$","g"),a=new RegExp("_commacheckbox\\d+$","g");function l(t){var n=document.getElementById(t),i=!n.checked,d=t.match(e),o=new RegExp("^mtm_(.+?)_"+d[1]+"_"+d[2]+"$","");Array_each(n.form.elements,function(e){var t=e.name;if(t&&o.test(t))if(void 0===e.widget_id)e.disabled!=i&&(e.disabled=i);else try{window[e.widget_type][e.widget_id].setEnabled(!i)}catch(e){}})}var r,m=!0;m=(m=m&&void 0!==$NXT_FORM_SETTINGS.merge_down_value&&$NXT_FORM_SETTINGS.merge_down_value&&!(is.ie&&is.mac))&&"undefined"!=typeof multiple_edits&&multiple_edits;utility.dom.getPageScroll(),utility.dom.getPageInnerSize();r=utility.dom.getElementsByClassName(document,"KT_tngform","DIV"),Array_each(r,function(r){var _;if(1==(_=utility.dom.getElementsByClassName(r,"KT_bottombuttons")).length){_=_[0];var u=utility.dom.getElementsByClassName(_,"KT_operations");Array_each(u,function(e){utility.dom.classNameAdd(e,"KT_left")})}if($NXT_FORM_SETTINGS.duplicate_buttons&&(!is.ie||!is.mac)&&1==(_=utility.dom.getElementsByClassName(r,"KT_bottombuttons","DIV")).length){_=_[0];var s=document.createElement("DIV");s.className="KT_topbuttons",s.innerHTML=_.innerHTML;_.parentNode.insertBefore(s,_.parentNode.firstChild);Array_each(["input"],function(e){var t=_.getElementsByTagName(e),n=s.getElementsByTagName(e);Array_each(t,function(e,i){n[i].__eventHandlers=t[i].__eventHandlers,n[i].onclick=t[i].onclick,n[i].onmousedown=t[i].onmousedown,n[i].onfocus=t[i].onfocus})})}var c=utility.dom.getElementsBySelector("div.KT_tngform table.KT_tngtable");m=m&&1==c.length;var y=utility.dom.getElementsByTagName(r,"label"),f=[];Array_each(y,function(r){var _=r.htmlFor.toString().replace(/_\d+$/,""),u=new RegExp("^"+_+"_\\d+$","g"),s=document.getElementById(_+"_1");if(void 0!==s&&null!=s&&s.tagName&&"undefined"!=s.tagName&&("input"!=s.tagName.toLowerCase()||!s.type||"file"!=s.type.toLowerCase())){var c=document.getElementById(r.htmlFor.toString()),y=!0;if(void 0!==c&&null!=c||(y=!1),y&&void 0!==c.type&&null!=c.type&&"radio"==c.type.toString().toLowerCase()&&(y=!1),y&&(e.test(r.htmlFor)&&(c.onclick=function(e){l(c.name)},c.checked||l(c.name)),m&&Array_indexOf(f,_)<0)){Array_push(f,_);var p=utility.dom.createElement("input",{type:"button",className:"merge_down",value:"v",tabIndex:1e3});p.onclick=function(r){var m=document.getElementById(_+"_1"),s=[],c=[],y={},f=m.form,p="";Array_each(f.elements,function(l){var r=l.id.toString();try{var f=l.name.toString()}catch(e){return}var v=f.match(e),B=f.match(t);!(r.match(u)&&l.id!=_+"_1"||v||B)||r.match(n)||r.match(i)||r.match(d)||r.match(o)||r.match(a)||(v?"1"==v[2]?"mtm_"+v[1]==_&&c.push([v[0],v[1],v[2]]):"mtm_"+v[1]==_&&(p="mtm_"+v[1]+"_1",void 0===y[p]&&(y[p]=[]),y[p].push([v[0],v[1],v[2]])):B?"1"==B[3]?"mtm_"+B[2]==_&&c.push([B[0],B[1],B[2],B[3]]):"mtm_"+B[2]==_&&(p="mtm_"+B[1]+"_"+B[2]+"_1",void 0===y[p]&&(y[p]=[]),y[p].push([B[0],B[1],B[2],B[3]])):(Array_push(s,l),void 0===y[m.name]&&(y[m.name]=[]),y[m.name].push([f])))}),/mtm_\d+/.test(_)||(c=[[m.name]]);for(var v=0;v<c.length;v++){if(m=f.elements[c[v][0]],s=y[c[v][0]],"undefined"!=typeof $DYS_GLOBALOBJECT&&void 0!==window[$DYS_GLOBALOBJECT][m.id])var B=window[$DYS_GLOBALOBJECT][m.id];if("undefined"!=typeof $DCC_GLOBALOBJECT&&void 0!==window[$DCC_GLOBALOBJECT][m.id])var w=window[$DCC_GLOBALOBJECT][m.id];if("undefined"!=typeof $DCM_GLOBALOBJECT&&void 0!==window[$DCM_GLOBALOBJECT][m.id]){var O=window[$DCM_GLOBALOBJECT][m.id];is.ie&&O.inspect()}if("undefined"!=typeof $MMO_GLOBALOBJECT&&void 0!==window[$MMO_GLOBALOBJECT][m.id])var L=window[$MMO_GLOBALOBJECT][m.id];for(var g=0;g<s.length;g++){var C=f.elements[s[g][0]];if("undefined"==typeof $DYS_GLOBALOBJECT||void 0===window[$DYS_GLOBALOBJECT][C.id])if("undefined"!=typeof $DCC_GLOBALOBJECT&&void 0!==window[$DCC_GLOBALOBJECT][C.id]&&(window[$DCC_GLOBALOBJECT][C.id].input.value=w.input.value,window[$DCC_GLOBALOBJECT][C.id].inspect()),"undefined"!=typeof $DCM_GLOBALOBJECT&&void 0!==window[$DCM_GLOBALOBJECT][C.id]&&(window[$DCM_GLOBALOBJECT][C.id].input.value=O.input.value,window[$DCM_GLOBALOBJECT][C.id].inspect()),"undefined"!=typeof $MMO_GLOBALOBJECT&&void 0!==window[$MMO_GLOBALOBJECT][C.id]&&(window[$MMO_GLOBALOBJECT][C.id].input.value=L.input.value,window[$MMO_GLOBALOBJECT][C.id].inspect()),"input"!=m.tagName.toLowerCase()||"checkbox"!=m.type)if("select"!=m.tagName.toLowerCase()){try{C.value=m.value}catch(r){}var E=UNI_isktml(m),T=UNI_isktml(C);E&&T&&("RICH"==T.displayMode?T.setContent(E.getContent()):T.textarea.value=hndlr_load(E.getContent(),"CODE"))}else{try{C.selectedIndex=m.selectedIndex}catch(r){}"undefined"!=typeof $DDR_MASTERSELECT_OBJ&&void 0!==window[$DDR_MASTERSELECT_OBJ][C.id]&&window[$DDR_MASTERSELECT_OBJ][C.id].change()}else try{C.checked=m.checked,e.test(C.name)&&l(C.name)}catch(r){}else if(dyp=window[$DYS_GLOBALOBJECT][C.id],"E"==dyp.edittype){if(B.addButton.disabled){var h=B.oldinput.selectedIndex;dyp.newvalue=B.newvalue,dyp.oldinput.selectedIndex=h,dyp.oldinput.value=B.oldinput.value,dyp.sel.selectedIndex=h,dyp.sel.value=B.sel.value,dyp.edit.value=B.edit.value,MXW_DynamicObject_syncSelection(C.id),dyp.addButton.disabled=!0}}else dyp.oldinput.value=B.oldinput.value,dyp.edit.value=B.edit.value}}},"undefined"!=typeof $CAL_GLOBALOBJECT&&void 0!==window[$CAL_GLOBALOBJECT]&&void 0!==window[$CAL_GLOBALOBJECT][c.id+""]&&(c=document.getElementById(c.id+"_btn")),utility.dom.insertAfter(p,c)}}})}),is.mozilla&&"function"==typeof nxt_form_ffdelayed_resizer&&setTimeout("nxt_form_ffdelayed_resizer()",0)}function nxt_form_ffdelayed_resizer(){for(var e=utility.dom.getElementsBySelector("div.KT_tngform input.merge_down"),t=0;t<e.length;t++){var n=e[t].offsetWidth;e[t].style.width="10px",e[t].style.width=n+"px"}}function nxt_form_insertasnew(e,t){var n=e.form;if(is.ie&&""==n.action)var i=window.location.href;else i=n.action.toString();parts=i.split("?");var d=new QueryString(parts[1]),o=[],a=new RegExp("^"+t,"g");Array_each(d.keys,function(e,t){e.match(a)||Array_push(o,e+"="+d.values[t])});var l=o.join("&");return i=parts[0],""!=l&&(i+="?"+l),n.action=i,!0}utility.dom.attachEvent2(window,"onload",nxt_form_attach),document.onreadystatechange=function(e){document.getElementById("form1").onsubmit=function(){document.getElementById("overlay").style.display="block",new Spinner(opts).spin(target)}};